(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{760:(e,t,s)=>{"use strict";s.d(t,{N:()=>g});var n=s(5155),a=s(2115),r=s(869),i=s(2885),l=s(7494),o=s(845),c=s(1508);class d extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=e instanceof HTMLElement&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:s,anchorX:r}=e,i=(0,a.useId)(),l=(0,a.useRef)(null),o=(0,a.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=(0,a.useContext)(c.Q);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:a,right:c}=o.current;if(s||!l.current||!e||!t)return;l.current.dataset.motionPopId=i;let d=document.createElement("style");return u&&(d.nonce=u),document.head.appendChild(d),d.sheet&&d.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===r?"left: ".concat(a):"right: ".concat(c),"px !important;\n            top: ").concat(n,"px !important;\n          }\n        ")),()=>{document.head.removeChild(d)}},[s]),(0,n.jsx)(d,{isPresent:s,childRef:l,sizeRef:o,children:a.cloneElement(t,{ref:l})})}let h=e=>{let{children:t,initial:s,isPresent:r,onExitComplete:l,custom:c,presenceAffectsLayout:d,mode:h,anchorX:p}=e,f=(0,i.M)(m),x=(0,a.useId)(),g=(0,a.useCallback)(e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;l&&l()},[f,l]),y=(0,a.useMemo)(()=>({id:x,initial:s,isPresent:r,custom:c,onExitComplete:g,register:e=>(f.set(e,!1),()=>f.delete(e))}),d?[Math.random(),g]:[r,g]);return(0,a.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[r]),a.useEffect(()=>{r||f.size||!l||l()},[r]),"popLayout"===h&&(t=(0,n.jsx)(u,{isPresent:r,anchorX:p,children:t})),(0,n.jsx)(o.t.Provider,{value:y,children:t})};function m(){return new Map}var p=s(2082);let f=e=>e.key||"";function x(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let g=e=>{let{children:t,custom:s,initial:o=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:u="sync",propagate:m=!1,anchorX:g="left"}=e,[y,b]=(0,p.xQ)(m),v=(0,a.useMemo)(()=>x(t),[t]),w=m&&!y?[]:v.map(f),j=(0,a.useRef)(!0),N=(0,a.useRef)(v),S=(0,i.M)(()=>new Map),[k,E]=(0,a.useState)(v),[C,M]=(0,a.useState)(v);(0,l.E)(()=>{j.current=!1,N.current=v;for(let e=0;e<C.length;e++){let t=f(C[e]);w.includes(t)?S.delete(t):!0!==S.get(t)&&S.set(t,!1)}},[C,w.length,w.join("-")]);let P=[];if(v!==k){let e=[...v];for(let t=0;t<C.length;t++){let s=C[t],n=f(s);w.includes(n)||(e.splice(t,0,s),P.push(s))}return"wait"===u&&P.length&&(e=P),M(x(e)),E(v),null}let{forceRender:D}=(0,a.useContext)(r.L);return(0,n.jsx)(n.Fragment,{children:C.map(e=>{let t=f(e),a=(!m||!!y)&&(v===C||w.includes(t));return(0,n.jsx)(h,{isPresent:a,initial:(!j.current||!!o)&&void 0,custom:s,presenceAffectsLayout:d,mode:u,onExitComplete:a?void 0:()=>{if(!S.has(t))return;S.set(t,!0);let e=!0;S.forEach(t=>{t||(e=!1)}),e&&(null==D||D(),M(N.current),m&&(null==b||b()),c&&c())},anchorX:g,children:e},t)})})}},2355:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(9946).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},3426:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var n=s(5155),a=s(2115),r=s(5695),i=s(6517),l=s(537),o=s(2355),c=s(9946);let d=(0,c.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),u=(0,c.A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var h=s(760),m=s(6413);function p(){let e=(0,r.useRouter)(),[t,s]=(0,a.useState)([]),[c,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(!1),[g,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(null),w=(0,a.useRef)(null),j=(0,a.useRef)(null),N=()=>{let e=new Date,t=e.getHours(),s=e.getMinutes().toString().padStart(2,"0"),n=t>=12?"PM":"AM";t%=12,t=t||12,y("".concat(t,":").concat(s," ").concat(n))},S=()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},k=async()=>{if(!c.trim()||f)return;let e={id:Date.now().toString(),text:c.trim(),sender:"user",timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};s(t=>[...t,e]),p(""),x(!0);try{let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e.text,analysis:b})});if(!t.ok)throw Error("Failed to get response");let n=await t.json(),a={id:(Date.now()+1).toString(),text:n.reply,sender:"ai",timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};s(e=>[...e,a])}catch(t){console.error("Error sending message:",t);let e={id:(Date.now()+1).toString(),text:"Sorry, I encountered an error. Please try again.",sender:"ai",timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};s(t=>[...t,e])}finally{x(!1)}},E=e=>{let t=e.target;t.style.height="auto",t.style.height="".concat(Math.min(t.scrollHeight,150),"px")};return(0,a.useEffect)(()=>{let e=localStorage.getItem("conversationAnalysis");e&&v(e),s([{id:Date.now().toString(),text:"Hi! I've analyzed your conversation style. How can I help you today?",sender:"ai",timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}]),N();let t=setInterval(N,6e4);return()=>clearInterval(t)},[]),(0,a.useEffect)(()=>{S()},[t]),(0,n.jsxs)("div",{className:"flex flex-col h-screen bg-black text-white",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center px-5 py-2 bg-black",children:[(0,n.jsx)("div",{className:"text-sm font-medium",children:g}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(i.A,{className:"h-4 w-4"}),(0,n.jsx)("div",{className:"text-sm",children:"8%"}),(0,n.jsx)(l.A,{className:"h-4 w-4"})]})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-2 bg-gray-900 border-b border-gray-800",children:[(0,n.jsx)("button",{onClick:()=>e.back(),className:"mr-2 p-2 -ml-2 rounded-full hover:bg-gray-800 transition-colors","aria-label":"Go back",children:(0,n.jsx)(o.A,{className:"h-5 w-5 text-blue-500"})}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"font-semibold text-sm",children:"AI Companion"}),(0,n.jsx)("div",{className:"text-xs text-gray-400",children:"Chat"})]})]}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-black",children:[(0,n.jsx)(h.N,{children:t.map(e=>(0,n.jsx)(m.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex ".concat("user"===e.sender?"justify-end":"justify-start"),children:(0,n.jsxs)("div",{className:"max-w-[80%] p-3 rounded-2xl ".concat("user"===e.sender?"bg-blue-500 text-white rounded-br-sm":"bg-gray-700 text-white rounded-bl-sm"),children:[(0,n.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:e.text}),(0,n.jsx)("p",{className:"text-xs text-gray-300 mt-1 opacity-70",children:e.timestamp})]})},e.id))}),(0,n.jsx)("div",{ref:w})]}),(0,n.jsx)("div",{className:"p-3 border-t border-gray-800 bg-gray-900",children:(0,n.jsxs)("div",{className:"flex items-center bg-gray-800 rounded-full px-3 py-2",children:[(0,n.jsx)("textarea",{ref:j,value:c,onChange:e=>{p(e.target.value),E(e)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:"Message...",className:"flex-1 bg-transparent text-white placeholder-gray-400 resize-none focus:outline-none text-sm",rows:1,style:{maxHeight:"150px"}}),(0,n.jsx)("button",{onClick:k,disabled:!c.trim()||f,className:"ml-2 p-1 rounded-full ".concat(!c.trim()||f?"text-gray-500":"text-blue-500"),"aria-label":"Send message",children:f?(0,n.jsx)(d,{className:"h-5 w-5 animate-spin"}):(0,n.jsx)(u,{className:"h-5 w-5"})})]})}),(0,n.jsx)("div",{className:"py-1 flex justify-center bg-black",children:(0,n.jsx)("div",{className:"w-24 h-1 bg-gray-600 rounded-full"})})]})}},3676:(e,t,s)=>{Promise.resolve().then(s.bind(s,3426))}},e=>{var t=t=>e(e.s=t);e.O(0,[871,441,684,358],()=>t(3676)),_N_E=e.O()}]);